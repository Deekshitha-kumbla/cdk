<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) on Fri Sep 16 07:08:44 BST 2022 -->
<title>Mappings (cdk 2.8 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2022-09-16">
<meta name="description" content="declaration: package: org.openscience.cdk.isomorphism, class: Mappings">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Mappings.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.openscience.cdk.isomorphism</a></div>
<h1 title="Class Mappings" class="title">Class Mappings</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.openscience.cdk.isomorphism.Mappings</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;int[]&gt;</code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public final class </span><span class="element-name type-name-label">Mappings</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;int[]&gt;</span></div>
<div class="block">A fluent interface for handling (sub)-graph mappings from a query to a target
 structure. The utility allows one to modify the mappings and provides
 convenience utilities. <a href="Mappings.html" title="class in org.openscience.cdk.isomorphism"><code>Mappings</code></a> are obtained from a (sub)-graph
 matching using <a href="Pattern.html" title="class in org.openscience.cdk.isomorphism"><code>Pattern</code></a>.

 <blockquote><pre>
 IAtomContainer query  = ...;
 IAtomContainer target = ...;

 Mappings mappings = Pattern.findSubstructure(query)
                            .matchAll(target);
 </pre></blockquote>

 The primary function is to provide an iterable of matches - each match is
 a permutation (mapping) of the query graph indices (atom indices).

 <blockquote><pre><code>
 for (int[] p : mappings) {
     for (int i = 0; i &lt; p.length; i++)
         // query.getAtom(i) is mapped to target.getAtom(p[i]);
 }
 </code></pre></blockquote>

 The matches can be filtered to provide only those that have valid
 stereochemistry.

 <blockquote><pre>
 for (int[] p : mappings.stereochemistry()) {
     // ...
 }
 </pre></blockquote>

 Unique matches can be obtained for both atoms and bonds.

 <blockquote><pre>
 for (int[] p : mappings.uniqueAtoms()) {
     // ...
 }

 for (int[] p : mappings.uniqueBonds()) {
     // ...
 }
 </pre></blockquote>

 As matches may be lazily generated - iterating over the match twice (as
 above) will actually perform two graph matchings. If the mappings are needed
 for subsequent use the <a href="#toArray()"><code>toArray()</code></a> provides the permutations as a
 fixed size array.

 <blockquote><pre>
 int[][] ps = mappings.toArray();
 for (int[] p : ps) {
    // ...
 }
 </pre></blockquote>

 Graphs with a high number of automorphisms can produce many valid matchings.
 Operations can be combined such as to limit the number of matches we
 retrieve.

 <blockquote><pre>
 // first ten matches
 for (int[] p : mappings.limit(10)) {
     // ...
 }

 // first 10 unique matches
 for (int[] p : mappings.uniqueAtoms()
                        .limit(10)) {
     // ...
 }

 // ensure we don't waste memory and only 'fix' up to 100 unique matches
 int[][] ps = mappings.uniqueAtoms()
                      .limit(100)
                      .toArray();
 </pre></blockquote>

 There is no restrictions on which operation can be applied and how many times
 but the order of operations may change the result.

 <blockquote><pre>
 // first 100 unique matches
 Mappings m = mappings.uniqueAtoms()
                      .limit(100);

 // unique matches in the first 100 matches
 Mappings m = mappings.limit(100)
                      .uniqueAtoms();

 // first 10 unique matches in the first 100 matches
 Mappings m = mappings.limit(100)
                      .uniqueAtoms()
                      .limit(10);

 // number of unique atom matches
 int n = mappings.countUnique();

 // number of unique atom matches with correct stereochemistry
 int n = mappings.stereochemistry()
                 .countUnique();

 </pre></blockquote></div>
<dl class="notes">
<dt>Author:</dt>
<dd>John May</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="Pattern.html" title="class in org.openscience.cdk.isomorphism"><code>Pattern</code></a></li>
</ul>
</dd>
<DT><B>Source code: </B><DD><a href="https://github.com/cdk/cdk/tree/main/base/isomorphism/src/main/java/org/openscience/cdk/isomorphism/Mappings.java" target="_blank">main</a></DD>
<DT><B>Belongs to CDK module: </B><DD>isomorphism</DD>
<dt>Keywords:</dt>
<dd>substructure search, structure search, mappings, matching</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button><button id="method-summary-table-tab6" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab6', 3)" class="table-tab">Deprecated Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#atLeast(int)" class="member-name-link">atLeast</a><wbr>(int&nbsp;n)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Efficiently determine if there are at least 'n' matches

 </div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#count()" class="member-name-link">count</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Convenience method to count the number mappings.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#countUnique()" class="member-name-link">countUnique</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Convenience method to count the number of unique atom mappings.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#exclusiveAtoms()" class="member-name-link">exclusiveAtoms</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Filter the mappings for those which cover an exclusive set of atoms in
 the target.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#filter(java.util.function.Predicate)" class="member-name-link">filter</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link">Predicate</a>&lt;int[]&gt;&nbsp;predicate)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Filter the mappings and keep only those which match the provided
 predicate (Guava).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#first()" class="member-name-link">first</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Obtain the first match - if there is no first match an empty array is
 returned.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html" title="class or interface in java.util" class="external-link">Iterator</a>&lt;int[]&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#iterator()" class="member-name-link">iterator</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"></div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#limit(int)" class="member-name-link">limit</a><wbr>(int&nbsp;limit)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Limit the number of mappings - only this number of mappings will be
 generate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;T&gt;&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;T&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#map(java.util.function.Function)" class="member-name-link">map</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;int[],<wbr>T&gt;&nbsp;f)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Map the mappings to another type.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#stereochemistry()" class="member-name-link">stereochemistry</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Results now automatically consider stereo if it's present, to
             match without stereochemistry remove the stereo features.</div>
</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;int[]&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#stream()" class="member-name-link">stream</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Convert the Mappings to a Java 8 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link"><code>Stream</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int[][]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toArray()" class="member-name-link">toArray</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Mappings are lazily generated and best used in a loop.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>,<wbr><a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toAtomBondMap()" class="member-name-link">toAtomBondMap</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Convert the permutations to an atom-atom bond-bond map.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>,<wbr><a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toAtomMap()" class="member-name-link">toAtomMap</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Convert the permutations to a atom-atom map.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>,<wbr><a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>&gt;&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toBondMap()" class="member-name-link">toBondMap</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Convert the permutations to a bond-bond map.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toChemObjects()" class="member-name-link">toChemObjects</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Obtain the chem objects (atoms and bonds) that have 'hit' in the target molecule.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toSubstructures()" class="member-name-link">toSubstructures</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toSubstructuresStream()" class="member-name-link">toSubstructuresStream</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#uniqueAtoms()" class="member-name-link">uniqueAtoms</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Filter the mappings for those which cover a unique atoms in the
 target.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#uniqueBonds()" class="member-name-link">uniqueBonds</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Filter the mappings for those which cover a unique set of bonds in the
 target.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Iterable">Methods inherited from interface&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html#forEach(java.util.function.Consumer)" title="class or interface in java.lang" class="external-link">forEach</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html#spliterator()" title="class or interface in java.lang" class="external-link">spliterator</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="filter(java.util.function.Predicate)">
<h3>filter</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></span>&nbsp;<span class="element-name">filter</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link">Predicate</a>&lt;int[]&gt;&nbsp;predicate)</span></div>
<div class="block">Filter the mappings and keep only those which match the provided
 predicate (Guava).

 <blockquote><pre><code>

     final IAtomContainer query;
     final IAtomContainer target;

     // obtain only the mappings where the first atom in the query is
     // mapped to the first atom in the target
     Mappings mappings = Pattern.findSubstructure(query)
                                .matchAll(target)
                                .filter(new Predicate&lt;int[]&gt;() {
                                    public boolean apply(int[] input) {
                                        return input[0] == 0;
                                    }});

 </code></pre></blockquote></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>predicate</code> - a predicate</dd>
<dt>Returns:</dt>
<dd>fluent-api reference</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="map(java.util.function.Function)">
<h3>map</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;T&gt;</span>&nbsp;<span class="element-name">map</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html" title="class or interface in java.util.function" class="external-link">Function</a>&lt;int[],<wbr>T&gt;&nbsp;f)</span></div>
<div class="block">Map the mappings to another type. Each mapping is transformed using the
 provided function.

 <blockquote><pre><code>

     final IAtomContainer query;
     final IAtomContainer target;

     Mappings mappings = Pattern.findSubstructure(query)
                                .matchAll(target);

     // a string that indicates the mapping of atom elements and numbers
     Iterable&amp;lt;String&amp;gt; strs = mappings.map(new Function&lt;int[], String&gt;() {
         public String apply(int[] input) {
             StringBuilder sb = new StringBuilder();
             for (int i = 0; i &amp;lt; input.length; i++) {
                 if (i &gt; 0) sb.append(", ");
                 sb.append(query.getAtom(i))
                   .append(i + 1)
                   .append(" -&gt; ")
                   .append(target.getAtom(input[i]))
                   .append(input[i] + 1);
             }
             return sb.toString();
         }});

 </code></pre></blockquote></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>f</code> - function to transform a mapping</dd>
<dt>Returns:</dt>
<dd>iterable of the transformed type</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="limit(int)">
<h3>limit</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></span>&nbsp;<span class="element-name">limit</span><wbr><span class="parameters">(int&nbsp;limit)</span></div>
<div class="block">Limit the number of mappings - only this number of mappings will be
 generate.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>limit</code> - the number of mappings</dd>
<dt>Returns:</dt>
<dd>fluent-api instance</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stereochemistry()">
<h3>stereochemistry</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></span>&nbsp;<span class="element-name">stereochemistry</span>()</div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Results now automatically consider stereo if it's present, to
             match without stereochemistry remove the stereo features.</div>
</div>
<div class="block">Filter the mappings for those which preserve stereochemistry specified in
 the query.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>fluent-api instance</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="uniqueAtoms()">
<h3>uniqueAtoms</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></span>&nbsp;<span class="element-name">uniqueAtoms</span>()</div>
<div class="block">Filter the mappings for those which cover a unique atoms in the
 target. The unique atom mappings are a subset of the unique bond
 matches.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>fluent-api instance</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="#uniqueBonds()"><code>uniqueBonds()</code></a></li>
<li><a href="#exclusiveAtoms()"><code>exclusiveAtoms()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="exclusiveAtoms()">
<h3>exclusiveAtoms</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></span>&nbsp;<span class="element-name">exclusiveAtoms</span>()</div>
<div class="block">Filter the mappings for those which cover an exclusive set of atoms in
 the target. If a match overlaps with another one it is not returned. For
 example suppose we had the query <code>C~O</code> and matched against a
 carboxylic acid <code>*C(O)=O</code>, there are <b>2</b> unique matches but
 only <b>1</b> exclusive match. If we had two -CO2 groups
 (<code>c1ccc(C(O)=O)cc1C(O)=O</code> there are  unique matches and
 <code>2</code> exclusive matches.
 The exclusive atom mappings are therefore a subset of the unique atom
 matches.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>fluent-api instance</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="#uniqueAtoms()"><code>uniqueAtoms()</code></a></li>
<li><code>ExclusiveAtomMatches</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="uniqueBonds()">
<h3>uniqueBonds</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Mappings.html" title="class in org.openscience.cdk.isomorphism">Mappings</a></span>&nbsp;<span class="element-name">uniqueBonds</span>()</div>
<div class="block">Filter the mappings for those which cover a unique set of bonds in the
 target.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>fluent-api instance</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="#uniqueAtoms()"><code>uniqueAtoms()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toArray()">
<h3>toArray</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int[][]</span>&nbsp;<span class="element-name">toArray</span>()</div>
<div class="block">Mappings are lazily generated and best used in a loop. However if all
 mappings are required this method can provide a fixed size array of
 mappings.

 <blockquote><pre>

 IAtomContainer query  = ...;
 IAtomContainer target = ...;

 Pattern pat = Pattern.findSubstructure(query);

 // lazily iterator
 for (int[] mapping : pat.matchAll(target)) {
     // logic...
 }

 int[][] mappings = pat.matchAll(target)
                       .toArray();

 // same as lazy iterator but we now can refer to and parse 'mappings'
 // to other methods without regenerating the graph match
 for (int[] mapping : mappings) {
     // logic...
 }
 </pre></blockquote>

 The method can be used in combination with other modifiers.

 <blockquote><pre>

 IAtomContainer query  = ...;
 IAtomContainer target = ...;

 Pattern pat = Pattern.findSubstructure(query);

 // array of the first 5 unique atom mappings
 int[][] mappings = pat.matchAll(target)
                       .uniqueAtoms()
                       .limit(5)
                       .toArray();
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>array of mappings</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toAtomMap()">
<h3>toAtomMap</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>,<wbr><a href="../interfaces/IAtom.html" title="interface in org.openscience.cdk.interfaces">IAtom</a>&gt;&gt;</span>&nbsp;<span class="element-name">toAtomMap</span>()</div>
<div class="block">Convert the permutations to a atom-atom map.

 <blockquote><pre>
 for (Map&lt;IAtom,IAtom&gt; map : mappings.toAtomMap()) {
     for (Map.Entry&lt;IAtom,IAtom&gt; e : map.entrySet()) {
         IAtom queryAtom  = e.getKey();
         IAtom targetAtom = e.getValue();
     }
 }
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>iterable of atom-atom mappings</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toBondMap()">
<h3>toBondMap</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>,<wbr><a href="../interfaces/IBond.html" title="interface in org.openscience.cdk.interfaces">IBond</a>&gt;&gt;</span>&nbsp;<span class="element-name">toBondMap</span>()</div>
<div class="block">Convert the permutations to a bond-bond map.

 <blockquote><pre>
 for (Map&lt;IBond,IBond&gt; map : mappings.toBondMap()) {
     for (Map.Entry&lt;IBond,IBond&gt; e : map.entrySet()) {
         IBond queryBond  = e.getKey();
         IBond targetBond = e.getValue();
     }
 }
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>iterable of bond-bond mappings</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toAtomBondMap()">
<h3>toAtomBondMap</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>,<wbr><a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;&gt;</span>&nbsp;<span class="element-name">toAtomBondMap</span>()</div>
<div class="block">Convert the permutations to an atom-atom bond-bond map.

 <blockquote><pre>
 for (Map&lt;IChemObject,IChemObject&gt; map : mappings.toBondMap()) {
     for (Map.Entry&lt;IChemObject,IChemObject&gt; e : map.entrySet()) {
         IChemObject queryObj  = e.getKey();
         IChemObject targetObj = e.getValue();
     }

     IAtom matchedAtom = map.get(query.getAtom(i));
     IBond matchedBond = map.get(query.getBond(i));
 }
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>iterable of atom-atom and bond-bond mappings</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stream()">
<h3>stream</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;int[]&gt;</span>&nbsp;<span class="element-name">stream</span>()</div>
<div class="block">Convert the Mappings to a Java 8 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link"><code>Stream</code></a>. The Stream API was written after
 this class and provides much of the functionality (e.g. <a href="#map(java.util.function.Function)"><code>map(java.util.function.Function&lt;int[], T&gt;)</code></a> is <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#map(java.util.function.Function)" title="class or interface in java.util.stream" class="external-link"><code>Stream.map(java.util.function.Function)</code></a> etc. Unlike an Iterable, a stream cannot be traversed more
 than once.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the stream</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toChemObjects()">
<h3>toChemObjects</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../interfaces/IChemObject.html" title="interface in org.openscience.cdk.interfaces">IChemObject</a>&gt;</span>&nbsp;<span class="element-name">toChemObjects</span>()</div>
<div class="block">Obtain the chem objects (atoms and bonds) that have 'hit' in the target molecule.

 <blockquote><pre>
 for (IChemObject obj : mappings.toChemObjects()) {
   if (obj instanceof IAtom) {
      // this atom was 'hit' by the pattern
   }
 }
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>non-lazy iterable of chem objects</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toSubstructuresStream()">
<h3>toSubstructuresStream</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" title="class or interface in java.util.stream" class="external-link">Stream</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;</span>&nbsp;<span class="element-name">toSubstructuresStream</span>()</div>
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound. The atoms
 and bonds are the same as in the target molecule but there may be less of them.

 <blockquote><pre>
 IAtomContainer query, target
 Mappings mappings = ...;
 for (IAtomContainer mol : mol.toSubstructures()) {
    for (IAtom atom : mol.atoms())
      target.contains(atom); // always true
    for (IAtom atom : target.atoms())
      mol.contains(atom): // not always true
 }
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>lazy stream iterable of molecules</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toSubstructures()">
<h3>toSubstructures</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;<a href="../interfaces/IAtomContainer.html" title="interface in org.openscience.cdk.interfaces">IAtomContainer</a>&gt;</span>&nbsp;<span class="element-name">toSubstructures</span>()</div>
<div class="block">Obtain the mapped substructures (atoms/bonds) of the target compound. The atoms
 and bonds are the same as in the target molecule but there may be less of them.

 <blockquote><pre>
 IAtomContainer query, target
 Mappings mappings = ...;
 for (IAtomContainer mol : mol.toSubstructures()) {
    for (IAtom atom : mol.atoms())
      target.contains(atom); // always true
    for (IAtom atom : target.atoms())
      mol.contains(atom): // not always true
 }
 </pre></blockquote></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>non-lazy iterable of molecules</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="atLeast(int)">
<h3>atLeast</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">atLeast</span><wbr><span class="parameters">(int&nbsp;n)</span></div>
<div class="block">Efficiently determine if there are at least 'n' matches

 <blockquote><pre>
 Mappings mappings = ...;

 if (mappings.atLeast(5))
    // set bit flag etc.

 // are the at least 5 unique matches?
 if (mappings.uniqueAtoms().atLeast(5))
    // set bit etc.
 </pre></blockquote></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>n</code> - number of matches</dd>
<dt>Returns:</dt>
<dd>there are at least 'n' matches</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="first()">
<h3>first</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int[]</span>&nbsp;<span class="element-name">first</span>()</div>
<div class="block">Obtain the first match - if there is no first match an empty array is
 returned.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>first match</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="count()">
<h3>count</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">count</span>()</div>
<div class="block">Convenience method to count the number mappings. Note mappings are lazily
 generated and checking the count and then iterating over the mappings
 currently performs two searches. If the mappings are also needed, it is
 more efficient to check the mappings and count manually.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>number of matches</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="countUnique()">
<h3>countUnique</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">countUnique</span>()</div>
<div class="block">Convenience method to count the number of unique atom mappings. Note
 mappings are lazily generated and checking the count and then iterating
 over the mappings currently performs two searches. If the mappings are
 also needed, it is more efficient to check the mappings and count
 manually.

 The method is simply invokes <pre>mappings.uniqueAtoms().count()</pre>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>number of matches</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="iterator()">
<h3>iterator</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html" title="class or interface in java.util" class="external-link">Iterator</a>&lt;int[]&gt;</span>&nbsp;<span class="element-name">iterator</span>()</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html#iterator()" title="class or interface in java.lang" class="external-link">iterator</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" title="class or interface in java.lang" class="external-link">Iterable</a>&lt;int[]&gt;</code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2022. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
